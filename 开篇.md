# 开篇

## 为什么需要有一个统一的基类：Object？

1. **万物可追踪**。通过一个Object类型指针可以追踪到所有派生对象
2. **通用的属性和接口**。可以在Object里添加应用于所有对象的属性和接口
3. **统一的内存分配释放**。GC有一个统一的Object可以引用
4. **统一的序列化模型**。方便实现统一的序列化
5. **统计功能**。有了可追踪和统一接口，方便实现统计功能
6. **调试的便利**。对于调试内存来说，可以将地址转换成一个Object指针，方便调试
7. **为反射提供便利**。便于实现反射
8. **UI编辑的便利**。为了让UI的属性面板控件能编辑各种对象。不光需要反射功能的支持，还需要引用一个统一Object指针。

## 付出了那些代价

1. **针对太过复杂的Object基类**。UObject分了三层继承：（UObjectBase->UObjectBaseUtility->UObject），头两层还都没有子类。而Object相关的Flags常常把32位都给占完了。
2. **sizeof(UObject)==56**。现在各个平台内存也越来越宽裕了，所以这个问题已经解决得在可接受范围内了。
3. **规避多重继承**。尽量规避不要多重继承多个UObject子类，实在想要实现功能复用，也可以采用组合的组件模式，或者把共同逻辑写在C++的类型上，比如UE中众多的F开头的类就是如此的功能类。
4. **只能多学习了**。一方面UE提倡在BP里实现游戏逻辑，C++充当BP的VM，就可以完全对用户隐藏掉复杂性。另一方面，UE在UObject上也提供了大量的辅助设计，如UCLASS等各种宏的便利，NewObject方便接口，UHT的自动分析生成代码，尽量避免用户直接涉及到UObject的内部细节。所以单从一个使用者的角度来说，如今的状态已经挺友好的了。
